[#ftl]
[#setting url_escaping_charset="UTF-8"]

<div class="crud crud-edit">
<form method="post" action="${(action)!?html}" class="${formDef.cssStyleClass!}" id="${formDef.id!?html}-edit-form">
<div class="container">
<div class="row">
<div class="col-sm-7 col-sm-offset-2">
  ${pageHeader!}

  <div class="box box-primary">
    <div class="box-header">
      <div class="box-title">${formTitle!title!?html}</div>
      ${boxHeader!}
    </div>
    <div class="box-body">
      ${boxBodyHeader!}

      [#list formDef.fields as field]
        [#if (formMode == "EDIT" && field.allowEdit) || (formMode == "NEW" && field.allowCreate)]
          <div class="form-group">
            [#if ((field.controlType)!) != "CHECKBOX"]
              <label for="${field.name!?html}" class="control-label">${field.displayName!?html}</label>
            [/#if] 
            [#if field.readonly]
              <p class="form-control-static">${(field.getDisplayValue(resource, record, record[field.name]))!?html}</p> 
            [#elseif field.lookup]
              <select class="form-control" id="${field.name!?html}" name="${field.name!?html}" [#if field.required]required[/#if] [#if field.autofocus]autofocus[/#if]>
                [#if field.required]
                <option value=""></option>
                [/#if]
                [#list 0..field.lookupValues.valueCount-1 as index]
                <option value="${(field.lookupValues.getValue(index))!?html}" [#if ((field.lookupValues.getValue(index))!) == ((record[field.name])!)] selected="selected"[/#if]>${(field.lookupValues.getDisplayName(index))!?html}</option>
                [/#list]
              </select>
            [#elseif ((field.controlType)!) == "TEXT_AREA"]
              <textarea class="form-control" rows="3" id="${field.id!?html}" name="${field.name!?html}" placeholder="${field.placeholder!}"  [#if field.required]required[/#if] [#if field.autofocus]autofocus[/#if]>${(field.getDisplayValue(resource, record, record[field.name]))!?html}</textarea>
            [#elseif ((field.controlType)!) == "CHECKBOX"]
              <div class="checkbox">
                <label><input type="checkbox" id="${field.id!?html}" name="${field.name!?html}" value="true" [#if ((record[field.name])!)]checked="checked"[/#if]>${field.displayName!?html}</label>
              </div>
            [#elseif ((field.controlType)!) == "PASSWORD"]
            <input type="password" class="form-control" id="${field.id!?html}" name="${field.name!?html}" value="${(field.getDisplayValue(resource, record, record[field.name]))!?html}" placeholder="${field.placeholder!}"  [#if field.required]required[/#if] [#if field.autofocus]autofocus[/#if]>
            [#else]
              <input type="text" class="form-control" id="${field.id!?html}" name="${field.name!?html}" value="${(field.getDisplayValue(resource, record, record[field.name]))!?html}" placeholder="${field.placeholder!}"  [#if field.required]required[/#if] [#if field.autofocus]autofocus[/#if]>
            [/#if]
            [#if field.helpText??]
              <span class="help-block">${field.helpText!?html}</span>
            [/#if]
          </div>
        [/#if]
      [/#list]
      ${boxBodyFooter!}
    </div>
    <div class="box-footer">
      ${boxFooter!}
      <div class="form-group">
        <div class="buttons">
          <button type="submit" class="btn btn-primary submit">[#if formMode == "NEW"]Create[#else]Save Changes[/#if]</button>
            <a class="btn btn-link submit" href="${RequestHolder.referer!(subUrl!)}">Cancel</a>
        </div>
      </div>
    </div>
  </div>
  ${pageFooter!}
</div>
</div>
</div>
</form>
</div>
