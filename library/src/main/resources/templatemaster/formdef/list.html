[#ftl]
[#setting url_escaping_charset="UTF-8"]

<div class="crud crud-list">
<form method="post" action="${(action)!?html}" class="${formDef.cssStyleClass!}" id="${formDef.id!?html}-edit-form">

<div class="box box-primary">
  <div class="box-header">
    <div class="row">
      <div class="col-xs-4">
        <div class="box-title">${title!?html}</div>
      </div>
      <div class="col-xs-8">
        ${listPager!}
      </div>
    </div>
    <div class="row" style="margin-top: 1em;">
      <div class="col-xs-6 text-left">
        [#if formDef.allowDelete]
          <button type="submit" class="btn btn-default" formaction="${RequestHolder.url.setPath(subUrl + '/delete')}" disabled="disabled"><i class="fa fa-trash" aria-hidden="true"></i> Delete ${resource.pluralTitle}</button>
        [/#if]
      </div>
      <div class="col-xs-6 text-right">
        [#if formDef.allowCreate]
          <a class="btn btn-success" href="${RequestHolder.url.setPath(subUrl + '/new')}"><i class="fa fa-plus-circle" aria-hidden="true"></i> New ${resource.singularTitle}</a>
        [/#if]
      </div>
    </div>
  </div>
  
  <div class="box-body" style="margin-top: 0; padding-top: 0;">
    <div class="table-responsive"> 
      <table id="${formDef.id!}" class="display table table-bordered table-hover crud-list-table ${formDef.cssStyleClass!}" cellspacing="0">
          <thead>
              <tr>
                  <th class="text-center toggleSelectAll-cell"><input type="checkbox" id="toggleSelectAll"></th>
                  <th>#</th>
                  [#list formDef.listFields as field]
                    [#if field.showInList]
                        [#if field.allowSort]
                            [#if sortField! == field.name]
                                <th class="sort-asc"><a href="${RequestHolder.url.setPath(subUrl).setQueryParam('s', '-'+field.name)}">${field.displayName}<i class="fa fa-arrow-up"></i></a></th>
                            [#elseif sortField! == '-'+field.name]
                                <th class="sort-desc"><a href="${RequestHolder.url.setPath(subUrl).removeQueryParam('s')}">${field.displayName}<i class="fa fa-arrow-down"></i></a></th>
                            [#else]
                                <th class="sort-none"><a href="${RequestHolder.url.setPath(subUrl).setQueryParam('s', field.name)}">${field.displayName}<i class="fa fa-arrow-down"></i></a></th> <!-- invisible arrow to prevent table shift on sort -->
                            [/#if]
                        [#else]
                            <th>${field.displayName}</th>
                        [/#if]
                    [/#if]
                  [/#list]
                  <th>Actions</th>
              </tr>
          </thead>
          <tbody>
            [#list page.content as record]
                <tr>
                  <td class="text-center checkbox-cell"><input type="checkbox" name="id" value="${record.id}"></td>
                  <td>${record?index + 1}</td>
                  [#list formDef.listFields as field]
                    [#if field.showInList]
                        <td>${field.getDisplayValueHtmlEscaped(resource, record, record[field.name])!}</td>
                    [/#if]
                  [/#list]
                  <td class="actions">
                  [#if formDef.singleRecordActions?size > 0]
                    [#list formDef.singleRecordActions as action]
                      <a href="${RequestHolder.url.setPath(subUrl + '/' + action.subPath + '/' + record.id)}" [#if action.target??]target="${action.target}"[/#if]>${action.displayName}</a> |
                    [/#list]
                  [/#if]
                  <a href="${RequestHolder.url.setPath(subUrl + '/view/' + record.id)}">View</a>
                 [#if formDef.allowEdit]
                   | <a href="${RequestHolder.url.setPath(subUrl + '/edit/' + record.id)}">Edit</a></td>
                 [/#if]
                </tr>
            [/#list]
          </tbody>
      </table>
    </div>
  </div>
  <!-- /.box-body -->
  <div class="box-footer">
    <div class="row">
      <div class="col-sm-6">
      </div>
      <div class="col-sm-6">
        ${listPager!}
      </div>
    </div>
  </div>
</div>
<!-- /.box -->

</form>
</div>


